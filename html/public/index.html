<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <script src="vendor/jquery/jquery.js"></script>
    <script src="vendor/gitana/gitana.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css"/>

    <script src="bower_components/handlebars/handlebars.js"></script>

    <title>Welcome Page</title>

    <h1>List of your custom definitions</h1>


</head>
<body id="page-top">

<div id="new-list">
    <!--{{#each array.items}}-->
    <!--<li>-->
        <!--<p>Title: {{title}}</p>-->
        <!--<span>{{title}}</span>-->
    <!--</li>-->
    <!--&lt;!&ndash;<p>Title: {{title}}</p>&ndash;&gt;-->
    <!--&lt;!&ndash;<p>Qname: {{_qname}}</p>&ndash;&gt;-->
    <!--{{/each}}-->
</div>

<main id="main">
    <a href="#" onclick="loadIssue();">Load Github Issue</a>
</main>
<script id="issue-template" type="text/x-handlebars-template">
    <article>
        <header><h3>Issue #{{number}} ({{state}})</h3></header>
        <p>{{body}}</p>
        <footer><a href="{{url}}">created {{created_at}}</a></footer>
    </article>
</script>

</body>

<script type="text/javascript">
    Gitana.connect({
        "clientKey": "{{{clientKey}}}",
        "clientSecret": "{{{clientSecret}}}",
        "username": "{{{username}}}",
        "password": "{{{password}}}",
        "baseURL": "{{{baseURL}}}",
        "application": "{{{application}}}"
    }, function(err) {
        var array = [];
        this.datastore("content").readBranch("master").listDefinitions('custom', {
            "limit": -1
        }).each(function() {
            array.push(this.title);
            array.push(this.getQName());
        }).then(function() {
            var issue = {
                state: "closed",
                number: 5,
                created_at: "2016-03-31 16:23:13 UTC",
                body: "Instructions say GET /team and POST /newteam. Rspec wants GET/newteam and POST/team."
            };
            var template = Handlebars.compile(document.getElementById("issue-template").innerHTML);
            var result = template(issue);
            document.getElementsByTagName("main")[0].innerHTML += result;

            // document.getElementById('new-list').innerHTML = array;
        })
    });

</script>
</html>